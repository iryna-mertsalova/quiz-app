import{b as E}from"./chunk-NA6WQYLY.js";import{a as ye,b as Ce}from"./chunk-FGN3XTOO.js";import"./chunk-KFPUUSTB.js";import{$ as l,Aa as re,Ba as ae,C as Z,Fa as se,Ha as pe,I as c,Ja as le,L as _,La as me,M as y,Ma as de,Na as ce,Oa as ue,Pa as fe,Qa as ge,R as v,Ra as he,Sa as ve,Ta as xe,Ua as we,V as J,Va as h,W as X,Wa as I,X as r,Xa as _e,Y as k,_ as x,a as H,aa as o,b as L,ba as a,ca as u,da as $,e as g,ea as P,fa as Q,ga as f,h as j,ha as w,ia as G,j as V,ja as ee,k as U,ka as te,la as ie,ma as s,n as K,na as m,oa as N,p as Y,pa as ne,sa as C,ta as b,xa as oe,ya as q,za as S}from"./chunk-LJD7Z6LW.js";function O(n){return new DOMParser().parseFromString(n,"text/html").documentElement.textContent||n}var z=class n{item={page:"",text:"",title:"",link:""};getData(e){let t=e.trim();switch(t){case"/quizzes-catalog":this.item.page="quizzes catalog",this.item.link="quizzes-catalog";break;case"/statistics":this.item.page="statistics",this.item.link="statistics";break;case"refresh":this.item.page="new quiz session";break;case"":this.item.page="main page",this.item.link="main";break;default:this.item.page=t.toLowerCase(),this.item.link=t.toLowerCase();break}return t==="/finish"?this.item={link:"statistics",page:"statistics",title:"Finish quiz",text:"To get your quiz result, please, confirm this action and go to the page with the conclusion."}:t=="refresh"?(this.item.title="Refresh page",this.item.text=`Do you want to refresh your quiz?
 Your current result will be lost`):(this.item.title="Leave quiz",this.item.text="Are you sure you want to exit and cancel the quiz? Your answers will not be saved."),this.item}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Z({token:n,factory:n.\u0275fac,providedIn:"root"})};var F=class n{text="";control;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=c({type:n,selectors:[["app-ui-radio-button"]],inputs:{text:"text",control:"control"},decls:5,vars:7,consts:[[1,"radio"],["name","radio","type","radio",3,"id","value","formControl"],[1,"radio__label",3,"for"]],template:function(t,i){t&1&&(o(0,"span",0),u(1,"input",1),o(2,"label",2)(3,"app-ui-typography"),s(4),a()()()),t&2&&(r(),G("id","radio-",i.text,""),l("value",i.text)("formControl",i.control),r(),G("for","radio-",i.text,""),r(2),m(i.text))},dependencies:[de,ve,ue,xe,h],styles:['.radio[_ngcontent-%COMP%]{align-items:center;display:flex;margin:5px}.radio[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{cursor:pointer}.radio[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{opacity:0;position:absolute}.radio[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + .radio__label[_ngcontent-%COMP%]{display:flex}.radio[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + .radio__label[_ngcontent-%COMP%]:before{background:#fff;border:2px solid #DBE2EA;border-radius:100%;content:"";display:inline-block;height:1.4em;margin-right:10px;text-align:center;transition:all .25s ease;width:1.4em}.radio[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + .radio__label[_ngcontent-%COMP%]{color:#fff}.radio[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + .radio__label[_ngcontent-%COMP%]:before{background-color:#e23d69;border-color:#e23d69;box-shadow:inset 0 0 0 4px #fff}.radio[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:focus + .radio__label[_ngcontent-%COMP%]{color:#fff}.radio[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:focus + .radio__label[_ngcontent-%COMP%]:before{border-color:#e23d69;outline:none}']})};var D=class n{message="Please select an option to continue the quiz";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=c({type:n,selectors:[["app-ui-notification"]],decls:3,vars:1,consts:[[1,"flex","items-center","fixed","right-4","bottom-4","p-3","pr-5","bg-warning/70","text-bright","border-2","border-warning","rounded","z-10"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"app-ui-typography"),s(2),a()()),t&2&&(r(2),m(i.message))},dependencies:[h],encapsulation:2})};function $e(n,e){if(n&1&&($(0),u(1,"app-ui-radio-button",3),P()),n&2){let t=e.$implicit,i=w();r(),l("text",t)("control",i.formControl)}}function Pe(n,e){n&1&&u(0,"app-ui-notification",4)}var R=class n{getSelectedAnswer=new v;options=[];set setFormControl(e){this.formControl.setValue(e),this.formControl.valueChanges.subscribe(t=>{this.getSelectedAnswer.emit(t)})}isNotification$=new g(!1);formControl=new ge("",ce.required);value=null;isSelectedAnswer(){return this.formControl.invalid?(this.isNotification$.next(!0),setTimeout(()=>{this.isNotification$.next(!1)},1500),this.formControl.markAsTouched(),!1):!0}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=c({type:n,selectors:[["app-ui-radio-group"]],inputs:{options:"options",setFormControl:"setFormControl"},outputs:{getSelectedAnswer:"getSelectedAnswer"},decls:3,vars:2,consts:[[1,"radio-group","flex","flex-col","max-md:items-start","lg:items-start"],[4,"ngFor","ngForOf"],["class","absolute inset-2",4,"ngIf"],[3,"text","control"],[1,"absolute","inset-2"]],template:function(t,i){t&1&&(o(0,"div",0),x(1,$e,2,2,"ng-container",1),a(),x(2,Pe,1,0,"app-ui-notification",2)),t&2&&(r(),l("ngForOf",i.options),r(),l("ngIf",i.isNotification$.value))},dependencies:[q,S,F,D],encapsulation:2})};var qe=["radioGroup"];function ze(n,e){if(n&1&&($(0),u(1,"svg-icon",20),P()),n&2){let t=e.$implicit;r(),l("src",t)}}function Fe(n,e){if(n&1){let t=Q();o(0,"app-ui-button",21),f("click",function(){_(t);let p=w();return y(p.handlePrev())}),o(1,"span",18),s(2),a(),o(3,"span",19),s(4),a()()}if(n&2){let t=w();r(2),m(t.buttonTextLg.prev),r(2),m(t.buttonTextSm.prev)}}var W=class n{item={question:"",type:!1,difficulty:"",category:"",correct_answer:"",incorrect_answers:[]};options=new Array(4);id=0;selectedAnswer="";next=new v;prev=new v;getSelectedAnswer=new v;radioGroup;size=E;images=["avatars/Profile-1.svg","avatars/Profile-2.svg","avatars/Profile.svg"];setSelectedAnswer(e){this.getSelectedAnswer.emit(e)}get buttonTextLg(){return{prev:"Prev question",next:this.id===this.size?"Finish":"Next question"}}get buttonTextSm(){return{prev:"Prev",next:this.id===this.size?"Finish":"Next"}}handlePrev(){this.prev.emit()}handleNext(){this.radioGroup.isSelectedAnswer()&&this.next.emit()}getFormattedText(){let e=this.item.question,t=Math.floor(e.length/3),i=e.indexOf(" ",t),p=i+1,d=e.lastIndexOf(" ",e.length-t);return{start:e.slice(0,i),middle:e.slice(p,d),end:e.slice(d)}}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=c({type:n,selectors:[["app-ui-question-item"]],viewQuery:function(t,i){if(t&1&&ee(qe,5),t&2){let p;te(p=ie())&&(i.radioGroup=p.first)}},inputs:{item:"item",options:"options",id:"id",selectedAnswer:"selectedAnswer"},outputs:{next:"next",prev:"prev",getSelectedAnswer:"getSelectedAnswer"},decls:28,vars:13,consts:[["radioGroup",""],[1,"bg-success","px-7","py-10","rounded-3xl","flex","flex-col","items-center","justify-between","lg:min-h-[550px]"],[1,"w-full","flex","items-start","justify-between"],[1,"flex","items-center"],["type","H5","highlightText","framed","highlightColor","bg-warning"],["type","P1",1,"text-bright","ml-2"],[1,"flex"],[4,"ngFor","ngForOf"],["type","H6",1,"w-full","flex","justify-start","text-bright/90","underline","underline-offset-4","pt-3"],[1,"w-full","flex","text-bright","items-center","justify-start","flex-wrap","*:mr-2","py-6"],["type","H4",1,"mr-2"],["type","H4","highlightText","framed","highlightColor","bg-error"],["type","H4"],[1,"max-md:w-full","lg:min-w-2/5"],[3,"getSelectedAnswer","options","setFormControl"],[1,"flex","items-center","w-full","pt-10",3,"ngClass"],["class","*:bg-accent/15","type","ghost","iconState","prev",3,"click",4,"ngIf"],["type","accent","iconState","next",3,"click"],[1,"max-sm:hidden","sm:block"],[1,"max-sm:block","sm:hidden"],["svgClass","lg:w-20 lg:h-20 max-lg:w-16 max-lg:h-16 object-cover",3,"src"],["type","ghost","iconState","prev",1,"*:bg-accent/15",3,"click"]],template:function(t,i){if(t&1){let p=Q();o(0,"div",1)(1,"div",2)(2,"span",3)(3,"app-ui-typography",4),s(4),a(),o(5,"app-ui-typography",5),s(6),a()(),o(7,"span",6),x(8,ze,2,1,"ng-container",7),a()(),o(9,"app-ui-typography",8),s(10),a(),o(11,"span",9)(12,"app-ui-typography",10),s(13),a(),o(14,"app-ui-typography",11),s(15),a(),o(16,"app-ui-typography",12),s(17),a()(),o(18,"form",13)(19,"app-ui-radio-group",14,0),f("getSelectedAnswer",function(Me){return _(p),y(i.setSelectedAnswer(Me))}),a()(),o(21,"div",15),x(22,Fe,5,2,"app-ui-button",16),o(23,"app-ui-button",17),f("click",function(){return _(p),y(i.handleNext())}),o(24,"span",18),s(25),a(),o(26,"span",19),s(27),a()()()()}t&2&&(r(4),m(i.id),r(2),N("/",i.size,""),r(2),l("ngForOf",i.images),r(2),m(i.item.category),r(3),m(i.getFormattedText().start),r(2),m(i.getFormattedText().middle),r(2),m(i.getFormattedText().end),r(2),l("options",i.options)("setFormControl",i.selectedAnswer),r(2),l("ngClass",i.id==1?"justify-end":"justify-between"),r(),l("ngIf",i.id!=1),r(3),m(i.buttonTextLg.next),r(2),m(i.buttonTextSm.next))},dependencies:[oe,q,S,me,he,fe,I,h,R],encapsulation:2})};var B=class n{confirm=new v;data={page:"",link:"",text:"",title:""};onConfirm(){this.confirm.emit(!0)}onCancel(){this.confirm.emit(!1)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=c({type:n,selectors:[["app-ui-modal-window"]],inputs:{data:"data"},outputs:{confirm:"confirm"},decls:16,vars:3,consts:[["aria-labelledby","modal-title","role","dialog","aria-modal","true",1,"relative","z-10"],["aria-hidden","true",1,"fixed","inset-0","bg-muted/75","transition-opacity"],[1,"fixed","inset-x-0","top-1/4","z-10","w-screen","overflow-y-auto"],[1,"flex","min-h-full","items-end","justify-center","p-4","text-center","sm:items-center","sm:p-0"],[1,"relative","transform","overflow-hidden","rounded-xl","border-accent","border-4","bg-bright","text-left","shadow-xl","transition-all","lg:max-w-lg","max-md:max-w-sm","p-10","flex","flex-col","items-center"],[1,"flex","flex-col","items-center","text-center","w-full","*:py-1.5"],["type","H6"],["type","P1"],[1,"flex","max-md:flex-col","items-center","*:p-0.5"],["type","accent",3,"click"],["type","ghost",1,"*:text-accent",3,"click"]],template:function(t,i){t&1&&(o(0,"div",0),u(1,"div",1),o(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"app-ui-typography",6),s(7),a(),o(8,"app-ui-typography",7),s(9),a(),u(10,"div"),a(),o(11,"div",8)(12,"app-ui-button",9),f("click",function(){return i.onCancel()}),s(13,"Back to quiz"),a(),o(14,"app-ui-button",10),f("click",function(){return i.onConfirm()}),s(15),a()()()()()()),t&2&&(r(7),m(i.data.title),r(2),m(i.data.text),r(6),N("Go to ",i.data.page,""))},dependencies:[I,h],encapsulation:2})};function Re(n,e){if(n&1){let t=Q();o(0,"app-ui-modal-window",12),C(1,"async"),f("confirm",function(p){_(t);let d=w();return y(d.handleModalResponse(p))}),a()}if(n&2){let t=w();l("data",b(1,1,t.modalWindowData$))}}var Ie=class n{constructor(e,t,i,p){this.activeRoute=e;this.router=t;this.storeService=i;this.modalService=p}quiz="";questions$;isLoading$;currentIndex$=new g(0);currentQuestion$;answers$=new g([]);modalWindowState$=new g(!1);modalWindowChoice$=new g(!1);modalWindowData$=new g({page:"",title:"",text:"",link:""});nextRoute="";canDeactivate(){return this.currentIndex$.value==E&&(this.nextRoute="/finish"),this.modalWindowData$=new g(this.modalService.getData(this.nextRoute)),this.modalWindowState$.next(!0),this.modalWindowState$.value&&this.modalWindowChoice$.value?j(!0):j(!1)}unloadNotification(e){e.preventDefault()}onKeydownHandler(e){(e.key==="F5"||e.ctrlKey&&e.key==="r")&&(e.preventDefault(),this.nextRoute="refresh",this.modalWindowData$=new g(this.modalService.getData("refresh")),this.modalWindowState$.next(!0))}handleModalResponse(e){e?this.nextRoute=="refresh"?window.location.reload():(this.modalWindowChoice$.next(!0),this.router.navigateByUrl(this.modalWindowData$.value.link)):this.modalWindowChoice$.next(!1),this.modalWindowState$.next(!1)}get options(){return this.currentQuestion$.pipe(Y(1),V(e=>[...e.incorrect_answers,e.correct_answer].sort().reverse()))}get id(){return this.currentIndex$.value+1}ngOnInit(){this.quiz=this.activeRoute.snapshot.params.id,this.questions$=this.storeService.getQuestions(),this.isLoading$=this.storeService.getLoadingQuestions(),this.storeService.loadQuestions(Number.parseInt(this.quiz)),this.currentQuestion$=U([this.questions$,this.currentIndex$]).pipe(V(([e,t])=>{let i=e?.[t]||{question:"",type:!1,difficulty:"",category:"",correct_answer:"",incorrect_answers:[]};return this.decodeQuestion(i)})),this.router.events.pipe(K(e=>e instanceof se)).subscribe(e=>{this.nextRoute=e.url})}decodeQuestion(e){return L(H({},e),{question:O(e.question),category:O(e.category),correct_answer:O(e.correct_answer),incorrect_answers:e.incorrect_answers.map(O)})}nextQuestion(){let e=this.currentIndex$.value;e<E-1?this.currentIndex$.next(e+1):this.router.navigateByUrl("/finish")}prevQuestion(){let e=this.currentIndex$.value;e>0&&this.currentIndex$.next(e-1)}setSelectedAnswer(e){this.answers$.getValue()[this.currentIndex$.value]=e}static \u0275fac=function(t){return new(t||n)(k(pe),k(le),k(ye),k(z))};static \u0275cmp=c({type:n,selectors:[["app-quiz"]],hostBindings:function(t,i){t&1&&f("beforeunload",function(d){return i.unloadNotification(d)},!1,J)("keydown",function(d){return i.onKeydownHandler(d)},!1,X)},inputs:{quiz:"quiz"},standalone:!0,features:[ne],decls:23,vars:14,consts:[[1,"absolute","inset-x-0","top","flex","flex-col","items-center","justify-between","min-h-fit","w-full","bg-primary","pb-8"],[1,"first:text-bright","flex","items-center","*:p-1.5","pb-3","flex-wrap","justify-center","text-center","w-3/4"],["type","H2"],["type","H3"],["type","H2","highlightText","ellipse"],["type","P1",1,"text-bright","lg:w-3/12","max-md:w-9/12","pb-5","text-center","flex","justify-center"],["link","/quizzes-catalog",1,"mb-4","lg:hidden"],["size","md","type","accent","iconState","prev"],[1,"lg:w-1/2","md:w-2/3","max-md:w-10/12",3,"next","prev","getSelectedAnswer","id","item","options","selectedAnswer"],["link","/quizzes-catalog",1,"lg:absolute","max-lg:hidden","left-3"],[3,"show"],[3,"data","confirm",4,"ngIf"],[3,"confirm","data"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"div",1)(2,"app-ui-typography",2),s(3,"Emoji Bands "),a(),o(4,"app-ui-typography",3),s(5,"Quiz"),a(),o(6,"app-ui-typography",4),s(7,"."),a()(),o(8,"app-ui-typography",5),s(9,"Can you decipher these emoji clues to answer these music-related questions?"),a(),o(10,"app-ui-link",6)(11,"app-ui-button",7),s(12,"Go to catalog"),a()(),o(13,"app-ui-question-item",8),C(14,"async"),C(15,"async"),f("next",function(){return i.nextQuestion()})("prev",function(){return i.prevQuestion()})("getSelectedAnswer",function(d){return i.setSelectedAnswer(d)}),a(),o(16,"app-ui-link",9)(17,"app-ui-button",7),s(18,"Go to catalog"),a()()(),u(19,"app-ui-spinner",10),C(20,"async"),x(21,Re,2,3,"app-ui-modal-window",11),C(22,"async")),t&2&&(r(13),l("id",i.id)("item",b(14,6,i.currentQuestion$))("options",b(15,8,i.options))("selectedAnswer",i.answers$.getValue()[i.currentIndex$.value]),r(6),l("show",!!b(20,10,i.isLoading$)),r(2),l("ngIf",b(22,12,i.modalWindowState$)))},dependencies:[we,I,h,_e,Ce,W,B,ae,S,re],encapsulation:2})};export{Ie as QuestionComponent};
